- name: Install latest zsh
  apt:
    name: zsh
    state: latest
  become: yes

- name: Install oh my zsh
  git:
    repo: https://github.com/ohmyzsh/ohmyzsh.git
    dest: "{{ home_dir }}/.oh-my-zsh"
    depth: 1

- name: Install spaceship prompt
  git:
    repo: https://github.com/spaceship-prompt/spaceship-prompt.git
    dest: "{{ home_dir }}/.oh-my-zsh/custom/themes/spaceship-prompt"
    depth: 1

- name: link spaceship theme
  file:
    dest: "{{ home_dir }}/.oh-my-zsh/custom/themes/spaceship.zsh-theme"
    src: "{{ home_dir }}/.oh-my-zsh/custom/themes/spaceship-prompt/spaceship.zsh-theme"
    state: link

- name: Set login shell to zsh with `usermod`
  shell: |
    usermod --shell $(which zsh) $USER
  changed_when: false
  become: yes
